machine:
  services:
    - docker
  post:
    - wget -qO- get.nextflow.io | bash ; chmod 755 nextflow ; sudo ln -s ~/nextflow /usr/local/bin/
    - git clone --depth=1 https://github.com/IARCbioinfo/data_test.git

test:
  override:
    - | # run manually docker to do not search for :latest image on dockerhub
      cd ~/platypus-nf
      docker build -t iarcbioinfo/platypus-nf .
    - | # execute the tests
      cd ~ && nextflow run ~/platypus-nf/platypus.nf -with-docker iarcbioinfo/platypus-nf --help
    - |
      cd ~ && nextflow run ~/platypus-nf/platypus.nf -with-docker iarcbioinfo/platypus-nf --input_folder ~/data_test/BAM/ --ref ~/data_test/17.fasta --platypus_path /Platypus/bin/Platypus.py
